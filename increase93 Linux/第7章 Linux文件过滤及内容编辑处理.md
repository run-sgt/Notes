## 第7章 Linux文件过滤及内容编辑处理

2019-07-15 分类：[运维基础](https://www.increase93.com/?cat=5) 阅读(73) 评论(0)

1. **vi/vim：纯文本编辑器详解及快捷键**

1. **基础用法**

- **vi oldboy.txt #打开文件**
- **打开后无法直接编辑，需要按i进入编辑模式**
- **修改这个文件内容吧**
- **修改完后，按esc退出编辑模式**
- **:wq 保存退出 #注意":"必须是英文符号**

**补充:**

**:q! 强制退出不保存**

**:wq! 强制保存退出**

- **vi 的增强版是vim，用法与vi一样**
- **vim的优势主要体现在以下几个方面：**

**1、多级撤消**

**我们知道在vi里，按 u只能撤消上次命令，而在vim里可以无限制的撤消。**

**2、易用性**

**vi只能运行于unix中，而vim不仅可以运行于unix,windows ,mac等多操作平台。**

**3、语法加亮**

**vim可以用不同的颜色来加亮你的代码。**

**4、可视化操作**

**就是说vim不仅可以在终端运行，也可以运行于x window、 mac os、 windows。**

**5、对vi的完全兼容**

**某些情况下，你可以把vim当成vi来使用。**

**vi和vim都是Linux中的编辑器，不同的是vim比较高级，可以视为vi的升级版本。vi使用于文本编辑，但是vim更适用于coding。**

1. **vim模式转换图**

- **命令模式（初始模式）: 刚进入vim编辑器的默认模式**
- **编辑模式（插入模式）：用做文本编辑的模式，需要从命令模式下才能进入，回到命令模式需要使用ESC键**
- **底行模式（:模式）：需要从命令模式才能进入，回到命令模式需要使用ESC键**

![img](D:\Notes\md_img\071519_0709_7Linux1.png)

1. **命令模式**

   ↑k

   ←h →l(小写字母L)

   ↓j

   **把光标移动到文件的第1行 gg**

   **把光标移动到文件的最后一行 G**

   **把光标移动到文件的第100行 100gg**

   **将光标移动到行首 ^(shift+6)**

   **将光标移动到行尾 $(shift+4)**

   **删除光标所在位置到行尾的内容 D（大写字母）**

   **快速保存并退出 ZZ**

   **复制光标所在行 yy**

   **复制多行，光标所在行往下下 nyy(n是数字)**

   **粘贴 p**

   **多次粘贴 np（n是数字）**

   **删除/剪切一整行 dd**

   **删除/剪切多行(光标所在行往下) ndd（n是数字）**

   **删除当前行到文件的结尾 dG**

   **撤销 u**

   **替换光标所在字符 r**

   **删除光标所在字符 x（delete）**

   **查找快捷键 /"要查找内容"**

   **查找下一个 n**

   **查找上一个 N**

   **批量操作快捷键：**

   **批量删除：进入批量编辑模式（可视块）ctrl+v**

   **选择 上下左右（方向键）**

   **删除 d**

   **批量增加：进入批量编辑模式（可视块）ctrl+v**

   **选择区域 上下左右（方向键）**

   **输入大写的shift+i进入编辑模式**

   **编辑**

   **按下ESC键**

   ​        **删除多行：进入批量编辑模式（可视行）shift+v**

   ​                 **选择区域 上下左右（方向键）**

   ​                 **删除 d**

2. **编辑模式**

   **在光标之后开始插入数据     a**

   **在光标之前开始插入数据     i**

   **在光标所在行末尾开始插入数据     A**

   **在光标所在行行首开始插入数据     I**

   **在当前行下面插入一行并进入编辑模式 o（小写字母）**

   **在当前行上面插入一行并进入编辑模式 O（大写字母）**

   **删除光标所在位置到行尾的内容并进入编辑模式 C（大写字母）**

3. **底行模式**

   **:wq 保存退出**

   **😡 保存退出**

   **:q 退出**

   **:q! 强制退出不保存 ! 强制**

   **:set nu number显示行号**

   **:set nonu 取消显示行号**

   **:set list 给每行的最后一个字符加上标记**

   **:set nolist 取消标记**

   **：noh 取消高亮显示**

   **:%s###g 替换内容**

4. **vi/vim执行过程**

   ![img](D:\Notes\md_img\071519_0709_7Linux2.png)

   **编辑文件时，突然断开连接，再次打开时出现报错；可删除临时文件.oldboy.txt.swp，再次打开即可从新编辑；或者先采用**

   **vim -r oldboy.txt恢复下里面内容，保存完后，再将临时文件删除。**

5. **vim常见故障**

   ​    **模拟**

   ​        **编程文件的时候断开连接即可**

   ​        **再次编辑文件**

   ​    **故障**

   ​        **Found a swap file by the name ".vim.log.swp"**

   ​        **Swap file ".vim.log.swp" already exists**

   ​    **解决**

   ​        **删除临时文件或者先恢复内容再删除**

   **解决原理及解决流程图解**

   [**https://dwz.cn/cA1Ou2aB**](https://dwz.cn/cA1Ou2aB) **#区分大小写**

   1. **echo 显示输出文本内容**

   **echo命令：把echo后面的内容显示到屏幕。**

   **echo 内容 >> 文件名 表示把内容加到一个文件的末尾**

   **echo 内容 > 文件名 表示把内容覆盖原先的文件内容**

   **-e 开启转义**

   **转义**

   　　　　**\a         发出警告声；**

   　　　　**\b         删除前一个字符；**

   　　　　**\c         最后不加上换行符号；**

   　　　　**\f         换行但光标仍旧停留在原来的位置；**

   　　　　**\n         换行且光标移至行首；**

   　　　　**\r         光标移至行首，但不换行；**

   　　　　**\t         插入tab；**

   　　　　**\v         与\f相同；**

   　　　　**\\         插入\字符；**

   　　　　**\nnn     插入nnn（八进制）所代表的ASCII字符；**

   1. **cat 合并文件或查看文件内容**

   **cat 查看文件内容**

   **cat 常用选项**

   **-b 显示行编号（忽略空行）**

   **-n 显示所有行编号（包括空格）**

   **-A 在每行的最后一个字符加上$字符**

   **> 文件名清空文件内容**

   **cat > 文件 << EOF 以EOF 开头以EOF 结尾**

   **EOF 可以是任何字母或数字**

   **cat >> 文件 << EOF**

   **> 表示写入新内容即使之前有内容也会覆盖**

   **>> 表示在文件的末尾追加新内容之前的内容不覆盖**

   **例：**

   **cat >>oldboy.txt<<EOF**

   **oldboy**

   **123**

   **Lidao**

   **EOF**

   1. **more 分页显示文件内容**

   **一页一页显示文件的内容 （查看文件/日志内容）**

   **more看到文件最后一行直接退出**

   **空格/f 下一页 forward**

   **b 上一页**

   **q 退出 quit**

   1. **less 分页显示文件内容**

   **一页一页显示文件的内容 （查看文件/日志内容）**

   **less 看到文件最后一行不会直接退出**

   **空格/f 下一页 forward**

   **b 上一页 back**

   **q 退出 quit**

   **-N 显示行号**

   1. **head 显示文件内容头部**

   **head 显示文件的前几行(默认显示十行)**

   **-n5 == -5 前5行**

   1. **tail 显示文件内容尾部**

   **tail 显示文件的最后几行(默认显示十行)**

   **-n5 == -5 显示文件最后5行**

   **-f --follow 显示文件实时更新**

   **-F --follow --retry 如果文件不存在会不断进行重试**

   1. **grep 文本过滤工具(三剑客之一)**

   **-v 排除 取反**

   **-n 给grep过滤出来的内容加上行号**

   **-o 只显示过滤出来的字符，如有多个分开显示**

   **-E 配合扩展正则使用**

   **CentOS-7系统会自动给过滤出来的字符加上颜色**

   **CentOS-6需要设置别名**

   1. **tr 替换或删除字符**

   **tr 替换 1对1的替换**

   **tr 与 < 连用**

   **-d 删除字符**

   **tr "a-z" "A-Z" < 文件名**

   **如何生成随机字符**

   **tr -cd "a-z" </dev/urandom |head -c10         #生成文件前十个a-z的字母**

   **tr -cd "a-z0-9" </dev/urandom |head -c10 #生成文件前十个a-z的字母和0-9的数字**

   1. ## 重定向符号的核心知识

      1. ### 重定向简介

   **重定向的意思是将"数据传到其他地方"。**

   1. ### 标准输入/输出/错误输出

   **标准输入（stdin）： 代码为0，使用<或<<。**

   **标准输出（stdout）： 代码为1，使用>或>>。**

   **标准错误输出（stderr）： 代码为2，使用2>或2>>。**

   **>>        追加重定向，把内容追加到文件的结尾**

   **>         重定向，先把文件内容清空，把内容追加到文件的结尾**

   **2>>     错误追加重定向，把错误内容追加到文件的结尾**

   **2>     错误重定向，先把文件内容清空，再把错误内容追加到文件的结尾**

   **2>&1 错误信息和正确信息放在一起#简写&>**

   1. **本章知识点总结**

- vi/vim纯文本编辑器
- echo命令
- cat命令
- more命令
- less命令
- head命令
- tail命令
- grep命令
- tr命令
- 重定向